{
  "rules": {
    // Admins can see the whole DB
    ".read": "auth.token.admin === true || auth.uid === 'reader'",
    ".write": "auth.token.admin === true",


    // List of approved articles and sources
    "data": {
      ".read": true,
      "$id": {
        "status": {
          "$category": {
            "$uid": {
              ".write": "auth != null && auth.uid == $uid"
            }
          }
        }
      }
    },
    // List of employed people
    "employed": {
      ".read": true
    },
    "company": {
      ".read": true
    },

    // User created suggestions, visible to admins
    // Anyone logged in can suggest in many categories
    "suggestions": {
      "$category": {
        "$suggestion": {
          ".write": "auth != null && !data.exists()"
        }
      }
    },

    // Per-user space that they can configure for themselves
    "user": {
      "$uid": {
        ".read": "auth != null && auth.uid == $uid",
        ".write": "auth != null && auth.uid == $uid"
      }
    },

    "external": {
      "kpo": {
        ".read": "true",
        ".write": "auth.uid === 'kpo-appender'"
      },
      "kpo_detailed": {
        ".read": "true",
        ".write": "auth.uid === 'kpo-appender'"
      },
      "rejestr-io": {
        ".read": "auth.uid === 'rejestr-io-appender'",
        ".write": "auth.uid === 'rejestr-io-appender' && !data.exists()",

        "$type": {
          "$id": {
            "$field": {
              // Allow appending to the empty fields
              ".write": "auth.uid === 'rejestr-io-appender' && !data.exists()"
            },
            "connections": {
              "$id": {
                ".write": "auth.uid === 'rejestr-io-appender'"
              }
            },
            "external_basic": {
              ".write": "auth.uid === 'rejestr-io-appender'"
            }
          }
        }
      }
    }
  }
}
